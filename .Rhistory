library(tidyverse)
library(patchwork)
finch.data <- read.csv("zebrafinches.csv")
View(finch.data)
close.t.stat <- t.test(x=finch.data$further, mu = 0, alternative = "greater")
close.t.stat
View(close.t.stat)
t.stat <- close.t.stat$statistic
further.sum <- finch.data |>
summarize(
mean = mean(further),
sd = sd(further),
skew = skewness(further)
)
further.sum <- finch.data |>
summarize(
mean = mean(further),
sd = sd(further),
skew = skew(further)
)
library(e1071)
further.sum <- finch.data |>
summarize(
mean = mean(further),
sd = sd(further),
skew = skewness(further)
)
t.pdf <- dnorm(x=finch.data$further, mean = further.sum$mean, sd = further.sum$sd)
n = length(finch.data)
error.val <- ((further.sum$skew)/(sqrt(n)))*(((2*t.stat^2)+1)/6)*t.pdf
fZ.at.t <- dnorm(t.stat, mean = 0, sd = 1)
n = nrow(finch.data)
close.t.stat <- t.test(x=finch.data$further, mu = 0, alternative = "less")
t.stat <- close.t.stat$statistic
fZ.at.t <- dnorm(t.stat, mean = 0, sd = 1)
error.val <- ((further.sum$skew)/(sqrt(n)))*(((2*t.stat^2)+1)/6)*fZ.at.t
skew.further <- further.sum$skew
t.seq <- seq(-10, 10, length.out=1000)
error.seq <- (skew.further / sqrt(n)) *
((2 * t.seq^2 + 1) / 6) *
fZ
fZ <- dnorm(t.seq, mean = 0, sd = 1)
error.seq <- (skew.further / sqrt(n)) *
((2 * t.seq^2 + 1) / 6) *
fZ
error.df <- tibble(
t     = t.seq,
error = error.seq
)
error.plot <- ggplot(error.df, aes(x = t, y = error)) +
geom_line(size = 1) +
labs(
title = "Edgeworth Approximation Error vs. t",
x     = "t statistic",
y     = "Approximation Error"
) +
theme_minimal()
error.plot
View(further.sum)
alpha = 0.05
assumed.t <- abs(qnorm(alpha))
assumed.fz <- dnorm(assumed.t)
tail.prob <- (((skew.further)/6*(0.10*alpha))*((2*assumed.t^2)+1)*assumed.fz)^2
closer       <- finch.data$closer
n.closer <- length(closer)        # or nrow(finch.data)
s.closer <- sd(closer)
resamples.null.closer <- replicate(R, {
x.bar <- sample(closer.null, size = n.closer, replace = TRUE)
mean(x.bar)/(s.closer/sqrt(n.closer))
})
R = 10000
set.seed(42)
resamples.null.closer <- replicate(R, {
x.bar <- sample(closer.null, size = n.closer, replace = TRUE)
mean(x.bar)/(s.closer/sqrt(n.closer))
})
closer.null  <- closer - mean(closer)
resamples.null.closer <- replicate(R, {
x.bar <- sample(closer.null, size = n.closer, replace = TRUE)
mean(x.bar)/(s.closer/sqrt(n.closer))
})
difference <- further - closer
further <- finch.data$further
difference <- further - closer
n.further = length(further)
n.diff = length(difference)
n.further = length(further)
n.diff = length(difference)
further.null = further - mean(further)
diff.null = difference - mean(difference)
sd.further = sd(further)
sd.diff = sd(difference)
p_closer_boot <- mean(
abs(resamples.null.closer) >= abs(t_closer)
)
t_closer    <- t.test(closer, mu = 0, alternative = "less")$statistic
p_closer_tt <- t.test(closer, mu = 0, alternative = "less")$p.value
t_further    <- t.test(further, mu = 0, alternative = "less")$statistic
p_further_tt <- t.test(further, mu = 0, alternative = "less")$p.value
t_diff      <- t.test(difference, mu = 0, alternative = "less")$statistic
p_diff_tt   <- t.test(difference, mu = 0, alternative = "less")$p.value
p_closer_boot <- mean(
abs(resamples.null.closer) >= abs(t_closer)
)
p_closer_boot
